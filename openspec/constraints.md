# OpenSpec Constraint Set

---

## å˜æ›´ 1: åŠ¨æ€ç‰ˆæœ¬åŠ è½½åŠŸèƒ½

### ç”¨æˆ·éœ€æ±‚
> downloadsä¸æ˜¯å¾ˆèƒ½åæ˜ shçš„é“¾æ¥ï¼Œå› ä¸ºè¦å¼€æºï¼Œè¦æ˜¯èƒ½çš„åŠ¨æ€åŠ è½½æœ€æ–°

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - setup.sh å·²æ›´æ–°ä¸ºåŠ¨æ€ç‰ˆæœ¬åŠ è½½æ¨¡å¼

## ç”¨æˆ·éœ€æ±‚
> downloadsä¸æ˜¯å¾ˆèƒ½åæ˜ shçš„é“¾æ¥ï¼Œå› ä¸ºè¦å¼€æºï¼Œè¦æ˜¯èƒ½çš„åŠ¨æ€åŠ è½½æœ€æ–°

## å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - setup.sh å·²æ›´æ–°ä¸ºåŠ¨æ€ç‰ˆæœ¬åŠ è½½æ¨¡å¼

## ç¡¬çº¦æŸ (Hard Constraints)

### 1. ç‰ˆæœ¬å‘ç°æœºåˆ¶ âœ…
- âœ… ä½¿ç”¨ GitHub Releases API `/releases/latest` ç«¯ç‚¹
- âœ… API ç«¯ç‚¹æ— è®¤è¯è®¿é—®ï¼ˆå…¬å¼€ç«¯ç‚¹ï¼‰
- âœ… ä»“åº“åœ°å€å›ºå®šï¼š
  - v2rayA: `https://api.github.com/repos/v2rayA/v2rayA/releases/latest`
  - Xray-core: `https://api.github.com/repos/XTLS/Xray-core/releases/latest`

### 2. èµ„æºå‘½åæ¨¡å¼ âœ…
- âœ… v2rayA debian x64: `installer_debian_x64_{VERSION}.deb`
- âœ… Xray-core linux x64: `Xray-linux-64.zip`
- âœ… ç‰ˆæœ¬å·æ ¼å¼ï¼š`v{major}.{minor}.{patch}`ï¼ˆå¦‚ v2.2.7.5, v26.2.6ï¼‰

### 3. ä¸‹è½½ URL æ„é€  âœ…
- âœ… v2rayA: `https://github.com/v2rayA/v2rayA/releases/download/{version}/installer_debian_x64_{version}.deb`
- âœ… Xray-core: `https://github.com/XTLS/Xray-core/releases/download/{version}/Xray-linux-64.zip`

### 4. å¤±è´¥å¤„ç† âœ…
- âœ… API è°ƒç”¨å¤±è´¥æ—¶æŠ¥é”™å¹¶é€€å‡º
- âœ… èµ„æºä¸‹è½½å¤±è´¥æ—¶æŠ¥é”™å¹¶é€€å‡º
- âœ… ç‰ˆæœ¬å·è§£æå¤±è´¥æ—¶æŠ¥é”™å¹¶é€€å‡º
- âœ… ä¸é™é»˜å¤±è´¥æˆ–ä½¿ç”¨é»˜è®¤å€¼

### 5. å…¼å®¹æ€§çº¦æŸ âœ…
- âœ… ä¿æŒ `install_v2raya_simple.sh` çš„è°ƒç”¨æ¥å£ä¸å˜
- âœ… æ–‡ä»¶ç»“æ„æ£€æŸ¥é€»è¾‘é€‚é…æ–°æ ¼å¼
- âœ… å¤„ç† `.deb` å’Œ `.zip` ä¸¤ç§ä¸åŒçš„åŒ…æ ¼å¼

## è½¯çº¦æŸ (Soft Constraints)

### 1. ç”¨æˆ·ä½“éªŒ âœ…
- âœ… æ˜¾ç¤ºæ­£åœ¨è·å–çš„ç‰ˆæœ¬å·
- âœ… æ˜¾ç¤ºä¸‹è½½è¿›åº¦ï¼ˆwget --show-progressï¼‰
- âœ… æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯

### 2. ä»£ç å¯è¯»æ€§ âœ…
- âœ… ä½¿ç”¨æ¸…æ™°çš„å˜é‡å
- âœ… æ·»åŠ å¿…è¦çš„æ³¨é‡Š
- âœ… éµå¾ªç°æœ‰çš„è„šæœ¬é£æ ¼

### 3. æ¶æ„æ‰©å±•æ€§ âœ…
- âœ… æ”¯æŒæ£€æµ‹ç³»ç»Ÿæ¶æ„ï¼ˆamd64, arm64, armv7, loongarch64, mips32/64, riscv64 ç­‰ï¼‰
- âœ… æ ¹æ®æ¶æ„é€‰æ‹©å¯¹åº”çš„åŒ…

## ä¾èµ–å…³ç³»

### å¤–éƒ¨å·¥å…·ä¾èµ– âœ…
- âœ… `curl` æˆ– `wget`ï¼šç”¨äºä¸‹è½½æ–‡ä»¶å’Œ API è°ƒç”¨
- âœ… `jq`ï¼šç”¨äºè§£æ JSONï¼ˆGitHub API å“åº”ï¼‰
- âœ… `dpkg`ï¼šç”¨äºå®‰è£… .deb åŒ…
- âœ… `unzip`ï¼šç”¨äºè§£å‹ .zip æ–‡ä»¶ï¼ˆXray-coreï¼‰

### å†…éƒ¨ä¾èµ– âœ…
- âœ… `install_v2raya_simple.sh`ï¼šåŠ¨æ€ç”Ÿæˆçš„å®é™…å®‰è£…è„šæœ¬

## å®æ–½æ€»ç»“

### ä¸»è¦å˜æ›´æ–‡ä»¶
- `setup.sh` - å®Œå…¨é‡å†™ï¼Œæ–°å¢ä»¥ä¸‹åŠŸèƒ½ï¼š
  - `detect_arch()` - è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿæ¶æ„
  - `check_dependencies()` - æ£€æŸ¥å¿…è¦å·¥å…·
  - `get_latest_version()` - ä» GitHub API è·å–æœ€æ–°ç‰ˆæœ¬
  - `download_file()` - ç»Ÿä¸€ä¸‹è½½å‡½æ•°
  - åŠ¨æ€ç”Ÿæˆ `install_v2raya_simple.sh`

### æ‰§è¡Œæµç¨‹
```
1. æ£€æµ‹ç³»ç»Ÿæ¶æ„ â†’ 2. æ£€æŸ¥ä¾èµ–å·¥å…· â†’ 3. è·å–æœ€æ–°ç‰ˆæœ¬
4. ä¸‹è½½ v2rayA .deb â†’ 5. ä¸‹è½½ Xray .zip â†’ 6. è§£å‹ Xray
7. ç”Ÿæˆå®‰è£…è„šæœ¬ â†’ 8. æ‰§è¡Œå®‰è£…
```

## é£é™©ç¼“è§£æªæ–½

| é£é™© | ç¼“è§£æªæ–½ |
|------|----------|
| GitHub API é€Ÿç‡é™åˆ¶ | æ— è®¤è¯ç«¯ç‚¹è¶³å¤Ÿï¼Œå·²æ·»åŠ é”™è¯¯å¤„ç† |
| ç½‘ç»œè¿æ¥é—®é¢˜ | wget æ˜¾ç¤ºè¿›åº¦å¹¶æä¾›æ¸…æ™°é”™è¯¯ä¿¡æ¯ |
| ç‰ˆæœ¬ä¸å…¼å®¹ | GitHub å‘å¸ƒç‰ˆæœ¬ç»è¿‡æµ‹è¯•ï¼Œé£é™©è¾ƒä½ |
| jq ä¾èµ–ç¼ºå¤± | æ£€æŸ¥ jq æ˜¯å¦å®‰è£…ï¼Œæä¾›å®‰è£…æç¤º |

## æˆåŠŸåˆ¤æ® âœ…

1. âœ… è„šæœ¬èƒ½å¤ŸæˆåŠŸè·å–æœ€æ–°çš„ v2rayA å’Œ Xray-core ç‰ˆæœ¬å·
2. âœ… èƒ½å¤Ÿæ­£ç¡®ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼ˆ.deb å’Œ .zip æ ¼å¼ï¼‰
3. âœ… å®‰è£…è¿‡ç¨‹èƒ½å¤Ÿæ­£å¸¸å®Œæˆ
4. âœ… å®‰è£…çš„è½¯ä»¶ç‰ˆæœ¬ä¸ GitHub æœ€æ–°ç‰ˆæœ¬ä¸€è‡´
5. âœ… é”™è¯¯æƒ…å†µä¸‹èƒ½å¤Ÿæä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å¹¶é€€å‡º

## åç»­æ‰©å±•å»ºè®®

1. **å¤šæ¶æ„æµ‹è¯•** - åœ¨ arm64 ç­‰é amd64 å¹³å°æµ‹è¯•
2. **ç‰ˆæœ¬é”å®š** - æ·»åŠ  `--version` å‚æ•°å…è®¸æŒ‡å®šç‰¹å®šç‰ˆæœ¬
3. **ç¦»çº¿æ¨¡å¼** - æ”¯æŒä»æœ¬åœ°ç¼“å­˜å®‰è£…
4. **é•œåƒæº** - æ·»åŠ å›½å†…é•œåƒæºæ”¯æŒä»¥åŠ å¿«ä¸‹è½½é€Ÿåº¦
5. **ç­¾åéªŒè¯** - æ·»åŠ  GPG ç­¾åéªŒè¯ç¡®ä¿ä¸‹è½½å®Œæ•´æ€§

---

## å˜æ›´ 2: ä¸€æ¡ curl å‘½ä»¤å®Œæˆå…¨è‡ªåŠ¨å®‰è£…

### ç”¨æˆ·éœ€æ±‚
> å½“å‰ setup.sh èƒ½å¦ç”¨ä¸€æ¡curlå‘½ä»¤è¡Œå®Œæˆå…¨è‡ªåŠ¨å®‰è£…å’Œå¯åŠ¨å’Œè‡ªå¯åŠ¨

### å®æ–½çŠ¶æ€
ğŸ”„ **ä»£ç å®æ–½å®Œæˆ** - çº¦æŸåˆ†æã€ææ¡ˆå’Œä»£ç ä¿®æ”¹å·²å®Œæˆï¼Œå¾…éƒ¨ç½²æµ‹è¯•

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/one-curl-install/constraints.md](./changes/one-curl-install/constraints.md)

### ç›®æ ‡å‘½ä»¤
```bash
curl -fsSL <public-url> | sudo bash
```

### å…³é”®å˜æ›´
| é¡¹ç›® | å˜æ›´ |
|------|------|
| `check_dependencies()` | ä¿®æ”¹ä¸ºè‡ªåŠ¨å®‰è£…ä¾èµ–ï¼ˆjq, unzip, curl/wgetï¼‰ |
| éƒ¨ç½² | å°†è„šæœ¬æ‰˜ç®¡åˆ° GitHub raw URL |
| ç”¨æˆ·ä½“éªŒ | ä¸€æ¡å‘½ä»¤å®Œæˆä»ä¸‹è½½åˆ°æœåŠ¡è¿è¡Œ |

---

## å˜æ›´ 3: åˆ›å»º README.md

### ç”¨æˆ·éœ€æ±‚
> ç¼ºå°‘README.md å…ˆåˆ›å»ºï¼Œå°½é‡å°‘ä½¿ç”¨emoji

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - README.md å·²åˆ›å»ºï¼Œç¬¦åˆæ—  emoji çº¦æŸ

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/readme-creation/constraints.md](./changes/readme-creation/constraints.md)

### å…³é”®çº¦æŸ
| çº¦æŸ | è¯´æ˜ |
|------|------|
| ä¸ä½¿ç”¨ emoji | ç”¨æˆ·æ˜ç¡®è¦æ±‚ |
| åæ˜ å½“å‰ä»£ç çŠ¶æ€ | åŸºäºå®é™…çš„ setup.sh åŠŸèƒ½ |
| åŒ…å«ä¸€æ¡å‘½ä»¤å®‰è£… | æåŠ curl ç®¡é“å®‰è£…æ–¹å¼ |
| ç›®æ ‡ç³»ç»Ÿæ˜ç¡® | Ubuntu 22.04 (Jammy Jellyfish) |

---

## å˜æ›´ 4: æ·»åŠ  GitHub åŠ é€Ÿè¯´æ˜

### ç”¨æˆ·éœ€æ±‚
> æ›´æ–° @README.md å¹¶æ·»åŠ ä¸€ä¸ªgithubåŠ é€Ÿè¯´æ˜

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - README.md å·²æ·»åŠ  GitHub åŠ é€Ÿè¯´æ˜

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/readme-github-acceleration/constraints.md](./changes/readme-github-acceleration/constraints.md)

### å…³é”®çº¦æŸ
| çº¦æŸ | è¯´æ˜ |
|------|------|
| ä¸ä½¿ç”¨ emoji | README.md ç°æœ‰çº¦æŸ |
| æä¾›å¤šç§åŠ é€Ÿæ–¹æ¡ˆ | ghproxy, fastgit ç­‰ |
| åŒ…å«é€‚ç”¨åœºæ™¯è¯´æ˜ | è¯´æ˜ä½•æ—¶ä½¿ç”¨åŠ é€Ÿ |
| ä¿æŒåŸæœ‰å†…å®¹ç»“æ„ | å‘åå…¼å®¹ |

---

## å˜æ›´ 5: æ·»åŠ  Claude AI å‚ä¸è¯´æ˜

### ç”¨æˆ·éœ€æ±‚
> å†æ·»åŠ claudeåˆä½œè¯´æ˜æœ¬é¡¹ç›®aiå‚ä¸

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - README.md å·²æ·»åŠ  Claude AI å‚ä¸è¯´æ˜

---

## å˜æ›´ 6: ä¿®å¤ GitHub åŠ é€Ÿæºå’Œç§»é™¤æ‰˜ç®¡è¯´æ˜

### ç”¨æˆ·éœ€æ±‚
> æŒ‡å‡ºé—®é¢˜ï¼š1.å·²çŸ¥githubåŠ é€Ÿæºå·²ç»å¤±æ•ˆï¼Œæ”¹ä¸ºhttps://v6.gh-proxy.org 2.æœ¬é¡¹ç›®æ˜¯æä¾›æœåŠ¡ä¸ç”¨æŒ‡å¯¼ç”¨æˆ·æ‰˜ç®¡

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - README.md å·²æ›´æ–°

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/fix-github-acceleration/constraints.md](./changes/fix-github-acceleration/constraints.md)

### å…³é”®å˜æ›´
| é¡¹ç›® | å˜æ›´ |
|------|------|
| ç§»é™¤æ‰˜ç®¡è¯´æ˜ | "å°†è„šæœ¬æ‰˜ç®¡åˆ° GitHub å" â†’ ç›´æ¥ä½¿ç”¨å‘½ä»¤ |
| æ›¿æ¢åŠ é€Ÿæº | ghproxy/fastgit â†’ v6.gh-proxy.org |
| ç»Ÿä¸€åŠ é€Ÿæ–¹æ¡ˆ | å¤šä¸ªæ–¹æ¡ˆ â†’ å•ä¸€ v6.gh-proxy.org |

---

## å˜æ›´ 7: ä¿®å¤ URL æ„é€ é”™è¯¯

### ç”¨æˆ·éœ€æ±‚
> bugï¼šubuntuæ— æ³•root@localhost:~# curl ... | sudo bash

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - setup.sh å·²ä¿®å¤ï¼Œprint å‡½æ•°é‡å®šå‘åˆ° stderr

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/fix-url-construction/constraints.md](./changes/fix-url-construction/constraints.md)

### å…³é”®å˜æ›´
| å‡½æ•° | å˜æ›´ |
|------|------|
| print_info() | æ·»åŠ  `>&2` é‡å®šå‘åˆ° stderr |
| print_error() | æ·»åŠ  `>&2` é‡å®šå‘åˆ° stderr |
| print_warning() | æ·»åŠ  `>&2` é‡å®šå‘åˆ° stderr |

### é—®é¢˜åŸå› 
print_info è¾“å‡ºè¢«æ··å…¥ URL å˜é‡ä¸­ï¼Œå¯¼è‡´ URL æ ¼å¼é”™è¯¯ã€‚é€šè¿‡é‡å®šå‘æ—¥å¿—è¾“å‡ºåˆ° stderr è§£å†³ã€‚

---

## å˜æ›´ 8: ä¿®å¤æ–‡ä»¶åæ ¼å¼

### ç”¨æˆ·éœ€æ±‚
> bugï¼šubuntuæ— æ³•root@localhost:~# curl ... | sudo bash

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - setup.sh å·²ä¿®å¤ï¼Œæ–‡ä»¶ååŒ¹é…é€»è¾‘ä¼˜åŒ–

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/fix-filename-format/constraints.md](./changes/fix-filename-format/constraints.md)

### å…³é”®å˜æ›´
| å‡½æ•° | å˜æ›´ |
|------|------|
| get_latest_version() | ä» API è·å–å®é™…æ–‡ä»¶åï¼Œè¿”å›ç‰ˆæœ¬å·å’Œæ–‡ä»¶å |

### æ–‡ä»¶åæ ¼å¼å˜åŒ–
- v2rayA æ–‡ä»¶åæ ¼å¼ï¼šä» `installer_debian_x64_v2.2.7.5.deb` æ”¹ä¸º `installer_debian_x64_2.2.7.5.deb`ï¼ˆä½¿ç”¨ API è¿”å›çš„å®é™…æ–‡ä»¶åï¼‰
- API è°ƒç”¨å¢åŠ ï¼šæ¯ä¸ªé¡¹ç›®å¢åŠ  1 æ¬¡è°ƒç”¨

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/readme-claude-ai/constraints.md](./changes/readme-claude-ai/constraints.md)

### å…³é”®çº¦æŸ
| çº¦æŸ | è¯´æ˜ |
|------|------|
| ä¸ä½¿ç”¨ emoji | README.md ç°æœ‰çº¦æŸ |
| è¯´æ˜éœ€çœŸå®åæ˜  AI å‚ä¸æƒ…å†µ | è¯šå®æ€§åŸåˆ™ |
| ä½¿ç”¨ä¸“ä¸šã€å®¢è§‚çš„è¡¨è¿° | ä¸“ä¸šæ€§ |
| æ”¾åœ¨åˆé€‚çš„ä½ç½® | ç»“æ„åˆç†æ€§ |

---

## å˜æ›´ 9: ä¿®å¤ APT é•œåƒè‡ªåŠ¨ä¿®æ”¹å’Œä¸‹è½½é”™è¯¯æ–‡ä»¶

### ç”¨æˆ·éœ€æ±‚
> ä¿®æ”¹ï¼š1.ç¦æ­¢è‡ªåŠ¨ä¿®æ”¹é•œåƒæºï¼Œå‡ºé”™ç›´æ¥å‘Šè¯‰ç”¨æˆ· 2.v2rayAä¸‹è½½ä¸æ­£ç¡®ï¼Œä¸‹çš„æ ¡éªŒç txtè€Œä¸æ˜¯çœŸæ­£çš„

### å®æ–½çŠ¶æ€
âœ… **å·²å®æ–½** - setup.sh å·²ä¿®å¤

### å˜æ›´è¯¦æƒ…
è¯¦ç»†çº¦æŸå’Œå®æ–½è®¡åˆ’è¯·å‚è€ƒ: [openspec/changes/fix-apt-mirror-and-filename-match/constraints.md](./changes/fix-apt-mirror-and-filename-match/constraints.md)

### å…³é”®å˜æ›´
| é¡¹ç›® | å˜æ›´ |
|------|------|
| APT é•œåƒæº | ç§»é™¤è‡ªåŠ¨ä¿®æ”¹é€»è¾‘ï¼Œapt update å¤±è´¥æ—¶æç¤ºç”¨æˆ·æ‰‹åŠ¨é…ç½® |
| æ–‡ä»¶ä¸‹è½½ | ä¿®å¤ jq è¿‡æ»¤å™¨æ’é™¤ .sha256.txt æ–‡ä»¶ï¼Œä½¿ç”¨ endswith(".deb") |
| API è°ƒç”¨ | ç¼“å­˜ JSON å“åº”é¿å…å¤šæ¬¡è°ƒç”¨å¯¼è‡´çš„ç‰ˆæœ¬ä¸ä¸€è‡´ |
| ä¸‹è½½å·¥å…· | æ”¯æŒ wget å’Œ curlï¼Œä¼˜å…ˆ wgetï¼Œä¸å­˜åœ¨æ—¶å›é€€åˆ° curl |
| é”™è¯¯å¤„ç† | curl æ·»åŠ  --fail --show-errorï¼Œwget ä¿®å¤è¿›åº¦æ˜¾ç¤º |
